---
title: "Algospot :: BFS"
date: 2020-03-02 19:23:00 +0900
categories: 알고리즘_공부
tags: Algospot BFS
---

# Breadth-first Search (그래프의 너비 우선 탐색) : AOJ 29단원  
## BFS란
**시작점에서 가까운 정점부터 순서대로 방문하는 탐색 알고리즘이다.**  

BFS는각 정점을 방문할 때마다 모든 인접 정점들을 검사한다. 처음 발견한 정점은 방문할 예정인 정점이라고 기록한 뒤, 별도의 위치에 저장한다. 인접한 정점을 모두 검사하면, 지금까지 저장한 목록에서 다음 정점들을 꺼내서 검사한다. → **큐를 사용**  

BFS의 방문 순서는 정점의 목록에서 어떤 정점을 먼저 꺼내는지에 의해 결정된다.

모든 정점들은 다음의 세 상태를 순서대로 거친다.
- 아직 발견되지 않은 상태
- 발견되었지만 아직 방문되지 않은 상태 (큐에 저장됨)
- 방문된 상태

DFS처럼 BFS에서 새 정점을 발견하는 데 사용된 간선들만을 모은 트리를 너비 우선 탐색 스패닝 트리 (BFS Spanning Tree)라고 한다.

## BFS의 시간복잡도
모든 정점을 방문하고, 각 정점에 인접한 모든 간선을 확인한다. 따라서 인접 리스트로 구현한 경우는 `O(|V|+|E|)`이고, 인접 행렬로 구현한 경우는 `O(|V|^2)`이다.  

## BFS와 최단 거리
BFS 과정에서 간선 `(u,v)`를 통해 정점 v를 처음 발견해 큐에 넣었다면, 시작점으로부터 v까지의 최단 거리 `distance[v]`는 `distance[u]+1`과 같다.

- 증명
  - 시작점부터 u까지의 최단 경로 맨 뒤에 간선 `(u,v)`를 붙이면 길이 `distance[u]+1`인 경로를 얻을 수 있기 때문에, `distance[v]<=distance[u]+1`이다.
  - `distance[v]<distance[u]+1`이라 가정하자. 이 경로 상에서 v 바로 이전의 정점은 시작점으로부터의 거리가 `distance[u]`보다 작아야 한다. 그러면 이 정점은 u보다 먼저 방문되었어야 하고, 따라서 간선 `(u,v)`를 통해 v를 처음 발견했다는 가정과 모순된다. 따라서 `distance[v]>=distance[u]+1`이다.
  - 즉 `distance[v]==distance[u]+1`이다.

위 속성의 중요한 의미는 시작점으로부터 다른 모든 정점까지의 최단 경로를 BFS 스패닝 트리 위에서 찾을 수 있다는 것이다. 

- 구현
  - 시작으로부터 각 점까지의 최단 경로에서, 각 점의 parent를 저장한다.
